function [allCM] = averageCAT_WM(rdm, ind)

    % rdm2 = [mean(rdm(1:10, 1:10), 'all', 'omitnan') mean(rdm(1:10, 11:20), 'all', 'omitnan') mean(rdm(1:10, 21:30), 'all', 'omitnan') mean(rdm(1:10, 31:40), 'all', 'omitnan') mean(rdm(1:10, 41:50), 'all', 'omitnan') mean(rdm(1:10, 51:60), 'all', 'omitnan') ;...
    %     mean(rdm(11:20, 1:10), 'all', 'omitnan') mean(rdm(11:20, 11:20), 'all', 'omitnan') mean(rdm(11:20, 21:30), 'all', 'omitnan') mean(rdm(11:20, 31:40), 'all', 'omitnan') mean(rdm(11:20, 41:50), 'all', 'omitnan') mean(rdm(11:20, 51:60), 'all', 'omitnan') ;...
    %     mean(rdm(21:30, 1:10), 'all', 'omitnan') mean(rdm(21:30, 11:20), 'all', 'omitnan') mean(rdm(21:30, 21:30), 'all', 'omitnan') mean(rdm(21:30, 31:40), 'all', 'omitnan') mean(rdm(21:30, 41:50), 'all', 'omitnan') mean(rdm(21:30, 51:60), 'all', 'omitnan') ;...
    %     mean(rdm(31:40, 1:10), 'all', 'omitnan') mean(rdm(31:40, 11:20), 'all', 'omitnan') mean(rdm(31:40, 21:30), 'all', 'omitnan') mean(rdm(31:40, 31:40), 'all', 'omitnan') mean(rdm(31:40, 41:50), 'all', 'omitnan') mean(rdm(31:40, 51:60), 'all', 'omitnan') ;...
    %     mean(rdm(41:50, 1:10), 'all', 'omitnan') mean(rdm(41:50, 11:20), 'all', 'omitnan') mean(rdm(41:50, 21:30), 'all', 'omitnan') mean(rdm(41:50, 31:40), 'all', 'omitnan') mean(rdm(41:50, 41:50), 'all', 'omitnan') mean(rdm(41:50, 51:60), 'all', 'omitnan') ;...
    %     mean(rdm(51:60, 1:10), 'all', 'omitnan') mean(rdm(51:60, 11:20), 'all', 'omitnan') mean(rdm(51:60, 21:30), 'all', 'omitnan') mean(rdm(51:60, 31:40), 'all', 'omitnan') mean(rdm(51:60, 41:50), 'all', 'omitnan') mean(rdm(51:60, 51:60), 'all', 'omitnan') ;...
    %     ];


        rdm(logical(eye(size(rdm, 1)))) = nan; 




    [idu1 idu2 idu3] = unique(ind, 'First'); 

    allCM = [mean(rdm(idu2(1):idu2(2)-1, idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(1):idu2(2)-1, idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(1):idu2(2)-1, idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(1):idu2(2)-1, idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(1):idu2(2)-1, idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(1):idu2(2)-1, idu2(6):length(ind)), 'all', 'omitnan') ...

            mean(rdm(idu2(2):idu2(3)-1, idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(2):idu2(3)-1, idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(2):idu2(3)-1, idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(2):idu2(3)-1, idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(2):idu2(3)-1, idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(2):idu2(3)-1, idu2(6):length(ind)), 'all', 'omitnan') ...

            mean(rdm(idu2(3):idu2(4)-1, idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(3):idu2(4)-1, idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(3):idu2(4)-1, idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(3):idu2(4)-1, idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(3):idu2(4)-1, idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(3):idu2(4)-1, idu2(6):length(ind)), 'all', 'omitnan') ...

            mean(rdm(idu2(4):idu2(5)-1, idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(4):idu2(5)-1, idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(4):idu2(5)-1, idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(4):idu2(5)-1, idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(4):idu2(5)-1, idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(4):idu2(5)-1, idu2(6):length(ind)), 'all', 'omitnan') ...

            mean(rdm(idu2(5):idu2(6)-1, idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(5):idu2(6)-1, idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(5):idu2(6)-1, idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(5):idu2(6)-1, idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(5):idu2(6)-1, idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(5):idu2(6)-1, idu2(6):length(ind)), 'all', 'omitnan') ...

            mean(rdm(idu2(6):length(ind), idu2(1):idu2(2)-1), 'all', 'omitnan') mean(rdm(idu2(6):length(ind), idu2(2):idu2(3)-1), 'all', 'omitnan') mean(rdm(idu2(6):length(ind), idu2(3):idu2(4)-1), 'all', 'omitnan') ...
            mean(rdm(idu2(6):length(ind), idu2(4):idu2(5)-1), 'all', 'omitnan') mean(rdm(idu2(6):length(ind), idu2(5):idu2(6)-1), 'all', 'omitnan') mean(rdm(idu2(6):length(ind), idu2(6):length(ind)), 'all', 'omitnan') ...
        
        ];

        wCatSim = allCM (logical(eye(size(allCM)))); 


end