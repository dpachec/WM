function [EEG] = load_data_WM (subji, events)

currentFolder = pwd;

%2) Load MNI coordinates

% Freiburg data
cd 'D:\_WM\electrode_MNI'
sublist = dir('*ElecMNICoor');
sublist = {sublist.name};

for si=1:length(sublist)
    S = readtable(sublist{si});
    S = table2cell(S);
    all_elec{si,:} = S(:,1:4);
end
length_list_germany = length(sublist);

% Hangzhou data
cd ('china')
sublist = dir('*_frv.mat');
sublist = {sublist.name};
for si=1:length(sublist)
    clear x;
    load(sublist{si})
    labs = elec_mni_frv.label;
    chpos = num2cell(elec_mni_frv.chanpos);
    x(:, 1) = labs;
    x(:,2:4) = chpos;
    all_elec{si+length_list_germany,:}  =x;
end
cd .. 

length_list_GCH = length(all_elec);

% jings_data
cd ('jings_data')
sublist = dir('*_frv.mat');
sublist = {sublist.name};
for si=1:length(sublist)
    clear x;
    load(sublist{si})
    labs = elec_mni_frv.label;
    chpos = num2cell(elec_mni_frv.chanpos);
    x(:, 1) = labs;
    x(:,2:4) = chpos;
    all_elec{si+length_list_GCH,:}  =x;
end
cd .. 


allE{1} = all_elec{1};      %> 1    > sub01_100918
allE{2} = all_elec{2};      %> 2    > sub03_260918
allE{3} = allE{2};          %> 3    > sub03_260918
allE{4} = all_elec{3};      %> 4    > sub04_091018
allE{5} = allE{4};          %> 5    > sub04_091018
allE{6} = all_elec{4};      %> 6    > sub05_201018
allE{7} = allE{6};          %> 7     > sub05_201018
allE{8} = all_elec{5};      %> 8     > sub06_191118
allE{9} = allE{8};          %> 9     > sub06_191118
allE{10} = all_elec{6};     %> 10    > sub07_301118
allE{11} = allE{10};allE{12} = allE{10};allE{13} = allE{10};allE{14} = allE{10}; %> 11    > sub07_301118 %> 12    > sub07_301118  %> 13    > sub07_301118   %> 14    > sub07_301118
allE{15} = all_elec{7};     %> 15    > sub11_030219
allE{16} = allE{15};allE{17} = allE{15};allE{18} = allE{15};   %> 16 > sub11_030219  %> 17 > sub11_030219    %> 18 > sub11_030219
allE{19} = all_elec{8};     %> 19    > sub12_100219
allE{20} = allE{19};        %> 20    > sub12_100219
allE{21} = all_elec{9};     %> 21    > sub13_210219
allE{22} = allE{21};        %> 22    > sub13_210219
allE{23} = all_elec{10};    %> 23    > sub14_040319
allE{24} = allE{23};        %> 24    > sub14_040319
allE{25} = all_elec{11};    %> 25    > sub18_031520
allE{26} = allE{25};        %> 26    > sub18_031520
allE{27} = all_elec{12};    %> 27    > sub19_230520
allE{28} = allE{27};        %> 28    > sub19_230520
allE{29} = all_elec{13};    %> 29    > sub20_100720
allE{30} = allE{29};        %> 30    > sub20_100720
allE{31} = all_elec{14};    %> 31    > sub21_160720
allE{32} = allE{31};        %> 32    > sub21_160720
allE{33} = all_elec{15};    %> 33    > sub22_061120
allE{34} = allE{33};allE{35} = allE{33}; allE{36} = allE{33}; allE{37} = allE{33}; %> 34  > sub22_061120    %> 35 > sub22_061120    %> 36 > sub22_061120    %> 37 > sub22_061120
allE{38} = all_elec{16};     %> 38    > sub23_061220
allE{39} = allE{38};        %> 39    > sub23_061220     
allE{40} = all_elec{17};    %> 40    > sub24_110321
allE{41} = allE{40}; allE{42} = allE{40}; 
allE{43} = all_elec{18};    %> 43   >sub25_220321
allE{44} = allE{43}; allE{45} = allE{43}; allE{46}= allE{43};

%china
allE{47} = all_elec{19};    %> 40    > sub31_
allE{48} = allE{47};        %> 41    > sub31
allE{49} = all_elec{20};    %> 42    > sub32
allE{50} = allE{49};        %> 43    > sub32
allE{51} = all_elec{21};    %> 44    > sub33
allE{52} = allE{51};        %> 45    > sub33
allE{53} = all_elec{22};    %> 46    > sub34
allE{54} = allE{53};        %> 47    > sub34
allE{55} = all_elec{23};    %> 48    > sub35
allE{56} = allE{55};        %> 49    > sub35
allE{57} = all_elec{24};    %> 50    > sub36
allE{58} = allE{57};       %> 51    > sub36
allE{59} = all_elec{25};    %> 52    > sub37
allE{60} = allE{59};        %> 53    > sub37
allE{61} = all_elec{26};    %> 52    > sub38
allE{62} = allE{61};        %> 53    > sub38
allE{63} = all_elec{27};    %> 52    > sub39
allE{64} = allE{63};        %> 53    > sub39

%jin
allE{65} = all_elec{28}; 
allE{66} = allE{65}; allE{67} = allE{65}; allE{68} = allE{65};
allE{69} = all_elec{29};
allE{70} = allE{69}; allE{71} = allE{69}; 
allE{72} = all_elec{30};
allE{73} = allE{72}; allE{74} = allE{72}; allE{75} = allE{72};
allE{76} = all_elec{31};
allE{77} = allE{76}; allE{78} = allE{76}; allE{79} = allE{76};
allE{80} = all_elec{32};
allE{81} = allE{80}; allE{82} = allE{80}; allE{83} = allE{80};


%3)Load all data and assign events
%store current folder
cd 'D:\_WM\data\iEEG\set - monopolar'
sublist = dir('*_EEG.mat');
sublist = {sublist.name};
disp (['measurements -> ' num2str(length(sublist))]);


chans2exc{1} = {'ECR1'; 'ECR2'; 'ECR3'; ...
                'ECL1'; 'ECL2'; 'ECL3'; ...
                'PHL8'; 'HAL1'; 'HAL2'; ...
                'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';'Pz';'T1';'T2';...
                'ECR4'; 'ECR5'; 'ECR6'; ...
                'TAL1'; 'TAL2'; 'TAL3';...
                'TAR3'; 'TAR4'; 'TAR6';'TAR7'; ...
                'EKG 1';'EKG 2';
                'HAR4';
                };
chans2exc{2} = { 'TPL1';'TPL2';'TPL3'; 'TPL4';'HAL1';'HAL2';...
                 'HAL6'; 'HAL7';...
                 'EKG 1';'EKG 2'};  
chans2exc{3} = chans2exc{2};    
chans2exc{4} = { 'TAR1';'TAR2';'AR1';'AR2';'AR3';'HAR1';'HAR2';...
                 'AR7'; 'AR8'; 'HAR8'; 'HAR9'; 'TAR3'; 'TAR4'; 'TAR5'; 'TAR6'; ...
                 'EKG 1';'EKG 2'};  
chans2exc{5} = chans2exc{4};  
chans2exc{6} = { 'HAL1';'HAL2';'PHL1';'PHL2';'TAL1';'TAL2';'EL1';'EL2';'AL1';'AL2';'PHL3';...
                 'EL4'; 'EL5'; 'EL6'; 'PHL8'; 'TAL3'; 'TAL4'; 'TAL5'; ...
                 'EKG 1';'EKG 2'; ... 
                 };  
chans2exc{7} = chans2exc{6};
chans2exc{8} = {'PIR1';'PIR2';'PIR3';'PIR4';'PIR5';...
                'SIPR7'; 'PHR4';... 
                'AR7';'AR8'; 'TSR5';  'TSR6';...
                'EKG 1';'EKG 2';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';...
                'Cz';'Pz';'T1';'T2'};  chans2exc{9} = chans2exc{8};
chans2exc{10} = {'ECR1';'ECR2';'ECR3';'ECR4';'ECR5';'HAR2';...
                'HAR11';'FBR13';...
                'TAR4'; 'TAR6';'TAR7'; 'TAR8'; ...
                'EKG 1';'EKG 2';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';'Pz';...
                'T1';'T2'};
chans2exc{11} = chans2exc{10};chans2exc{12} = chans2exc{10};chans2exc{13} = chans2exc{10};chans2exc{14} = chans2exc{10};
chans2exc{15} = { 'HAR1';'HAR2';'HAR3'; 'AR1'; 'AR2'; 'AR3';...
                  'HAR8'; 'ER9';...
                  'TAR1'; 'TAR2'; 'TAR7'; 'TAR8'; ...
                  'EKG 1';'EKG 2';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';...
                  'Pz';'T1';'T2'};  
chans2exc{16} = chans2exc{15};chans2exc{17} = chans2exc{15};chans2exc{18} = chans2exc{15};
chans2exc{19} = {   'HL1';'HL2';'HL3';'HL4';'G_C1';...
                    'G_D1'; 'G_D2'; 'G_D6'; 'G_D7'; ...
                    'EKG 1';'EKG 2'};   chans2exc{20} = chans2exc{19};
chans2exc{21} = {   'HAR1';'HAR2';'PHR1';'PHR2';...
                    'AR4'; 'AR5'; 'ER8';'HAR6'; 'TMR3';...
                    'EKG 1';'EKG 2'; ...
                    };   chans2exc{22} = chans2exc{21};
chans2exc{23} = {   'PFL1';'PFL2';'PFL3';'PFL4';'PFL5';'PFL6';'PFL7';...
                    'PML1';'PML2';'PML3';'PML4';'PML5';...
                    'EKG 1';'EKG 2';...
                    };     chans2exc{24} = chans2exc{23};
chans2exc{25} = {   'PHAR1';'PHAR2';'TOR1';'PHAMR2';'TOR4'; ...
                    'TOR4'; 'TAR9'; 'HAR9';...
                    'PHAR8'; 'PHMR1'; 'PHMR2'; 'TAR1'; 'TAR4'; 'TAR5';...
                    'EKG 1';'EKG 2';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';...
                    'Pz';'T1';'T2'}; chans2exc{26} = chans2exc{25};
chans2exc{27} = {   'AR1';'AR2';'TAR5';'TAR6';'TAR1';'TAR2';'ER2'; 'ER3';...
                    'ER8'; 'ER9'; 'TML5';'AR9';'HAL1';  ...
                    'AL7'; 'HAL5'; 'PHL3'; ... 
                    'EKG 1';'EKG 2';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7';'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';...
                    'Pz';'T1';'T2'}; chans2exc{28} = chans2exc{27};
                
chans2exc{29} = {   'EKG 1';'EKG 2'; 'PHR9';'TAL4'; ...
                    'AR6'; 'AR7'; 'ER8'; 'HAL6'}; chans2exc{30} = chans2exc{29} ; 
chans2exc{31} = {   'EKG 1';'EKG 2'; 'ER1'; 'ER6'; 'TAR10';  ...
                    'ER7'; 'ER8'; 'PHR2'; 'TAR1';
                    'HAR4';
                    }; chans2exc{32} = chans2exc{31}; 
chans2exc{33} = {   'EKG 1';'EKG 2';'PHR9';'TAR1';'TAR2';'TAR3';'TAR3';'ER1'; 'ER2';'ER3'; 'AR1'; 'AR2';...
                        'AR8'; 'TAR4'; 'TAR7'}; 
chans2exc{34} = chans2exc{33} ; chans2exc{35} = chans2exc{33} ; chans2exc{36} = chans2exc{33} ; chans2exc{37} = chans2exc{33} ; 
chans2exc{38} = {   'EKG 1';'EKG 2';'LR7';'Fp1';'Fp2';'F3';'F4';'C3';'C4';'P3';'P4';'O1';'O2';'F7'; ...
                    'F8';'T3';'T4';'T5';'T6';'Fz';'Cz';'Pz';'T1';'T2'; ...
                    'TAR4'; 'TAR6'; ...
                    'TAR1';'TAR2';'TAR3';'LR1';'LR2';'LR3';'PHR1';'PHR2';'PHR3';'TMR1';'TMR2';'TMR3';'TMR4'};
chans2exc{39} = chans2exc{38} ; 
chans2exc{40} = {'XAL2' ; 'XPL2'; 'CAL4'; 'FBL2'}; 
chans2exc{41} = chans2exc{40} ; chans2exc{42} = chans2exc{40} ; 
chans2exc{43} = {'HAL1'; 'HAL2';'AL3';'AL6'; 
                 'EL1'; 'EL2'; 'TAL3'; 'TAL4'};
chans2exc{44} = chans2exc{43} ; chans2exc{45} = chans2exc{43} ; chans2exc{46} = chans2exc{43} ; 

                
%CHINA
chans2exc{47} = {   'EEG A1-Ref';'EEG A2-Ref';'POL A3';'POL A4';'POL A5';'POL A6';...
                    'POL B1';'POL B2';'POL B5';'POL B6';'POL B7';...
                    'EEG C1-Ref';'EEG C2-Ref';'EEG C3-Ref';'EEG C4-Ref';'EEG C5-Ref';'EEG C6-Ref'; ...
                    'POL D1';'POL D2';'POL D3';'POL D4';'POL D5'; ...
                    'POL E1';'POL E2';...
                    'POL E3';'POL E4';'POL E5';...
                    %visual inspection 
                    'POL A8';'EEG F10-Ref';'POL G7';...
                    'POL D13';'POL D14';'EEG F7-Ref';'EEG F8-Ref';'POL J10'; 'POL J11'; 'POL J12';
                    %common to all
                    'POL E';'POL EKG'; ...
                    

                };
chans2exc{48} = chans2exc{47};
chans2exc{49} = {'POL J1';'POL J2';'POL J3';'POL J4';'POL J5';'POL J6';'POL J7';'POL J8';'POL J9'; ...
                'POL B1';'POL B2';'POL B5';'POL B6';'POL B7';'POL B8';'POL B9';'POL B10';'POL B11';'POL B12';'POL B13';...
                'EEG C1-Ref';'EEG C2-Ref';'EEG C3-Ref';'EEG C4-Ref';'EEG C5-Ref';'EEG C6-Ref';'POL C7';'POL C8';'POL C9';'POL C10';'POL C11';'POL C12';...
                'POL E5';'POL E6';'POL E7';'POL E8';'POL E9';'POL E10';'POL E11';'POL E12';'POL E13';...
                'EEG A1-Ref';'EEG A2-Ref';'POL A3'...
                %visual inspection 
                %scalp eeg
                %common to all
                'POL E'; 'POL EKG';...
                
                };
                
chans2exc{50} = chans2exc{49}; 
            
chans2exc{51} = {'EEG C1-Ref';'EEG C2-Ref';'EEG C3-Ref';'EEG C4-Ref';'EEG C5-Ref';'EEG C6-Ref';...
                'POL B6';'POL B7';'POL B8';'POL B9';'POL B10';'POL B11';'POL B12';'POL B13';...
                'POL D6';'POL D7';'POL D8';'POL D9'; ...
                'EEG F7-Ref';'EEG F8-Ref';...
                'EEG A1-Ref';'EEG A2-Ref';'POL A3';'POL A4';...
                'POL J1';'POL J2';'POL J3';'POL J4';...
                'POL K1';'POL K2';'POL K3';...

                'POL A13'; ...

                %common to all
                'POL E';'POL EKG'; ...
                
                'POL B5'; ...
                'POL A6'; ...
                };
                
                
chans2exc{52} =  chans2exc{51};
                
chans2exc{53} = {'POL H8';'POL H9';'POL H10';'POL H11';'POL H12'; ...
    'POL A11';'POL A12'; ...
    'POL B9';'POL B10';...
    'EEG C1-Ref';'EEG C2-Ref';'EEG C3-Ref';'EEG C4-Ref';'EEG C5-Ref';'EEG C6-Ref';...
    'POL D1';'POL D2';'POL D3';'POL D4';'POL D5';'POL D6';...
    'POL E7';'POL E8';...
    'EEG F1-Ref';'EEG F2-Ref';'EEG F3-Ref';'EEG F4-Ref';'EEG F5-Ref';'EEG F6-Ref';'EEG F7-Ref';'EEG F8-Ref';'EEG F9-Ref';'EEG F10-Ref';'POL F11';'POL F12';...
    'POL G1';'POL G2';'POL G3';'POL G8';'POL G9';'POL G10';'POL G11';'POL G12';'POL G13';...
    'POL H8';'POL H9';'POL H10';'POL H11';'POL H12';'POL H13';'POL H14';'POL H15';...
    'POL I1';'POL I2';'POL I3';'POL I4';'POL I5';...
    'POL I16';'POL I17';...
    'POL J1';'POL J2';'POL J3';...
    'POL K1';'POL K2';'POL K3';'POL K4';'POL K5';'POL K6';'POL K7';'POL K8';'POL K9';'POL K10';'POL K11';'POL K12';'POL K13';...
    'POL L1';'POL L2';'POL L3';'POL L4';'POL L5';'POL L6';'POL L7';'POL L8';...
    'POL P11'; ...
    %scalp

    %visual inspection
    'POL A9';'POL K14';'POL K15';'POL O8';...
    %common to all
    'POL E'; 'POL EKG';
    'EEG P3-Ref'};

chans2exc{54} = chans2exc{53};

chans2exc{55} = {'POL B1';'POL B2';'EEG C1-Ref';'EEG C2-Ref';'POL D1';'POL D2';'POL D3';'POL D4';'POL D5';...
'POL K1';'POL K2';'POL K3';'POL K4';'POL K5';'POL K6';'POL K7';'POL K8';'POL K9';'POL K10';'POL K11';'POL K12';'POL K13';...
'EEG C6-Ref';'POL C7';'POL C8';...
'POL A9';'POL A10';'POL A11';'POL A12';...
'POL H1';'POL H2';'POL H3';'POL H4';'POL H5';'POL H6';'POL H7';'POL H8';...
'POL G1';'POL G2';...
'POL L1';'POL L2';'POL L3';'POL L4';'POL L5';'POL L6';'POL L7';'POL L8';'POL L9';'POL L10';...
'POL M6';'POL M7';'POL M8';...
%visual inspection
'POL D12';'POL L14';'POL L15';...
'EEG F3-Ref'; 'EEG F4-Ref'; 'EEG F5-Ref' ; 'EEG F6-Ref'; 'POL L12 '; 
'EEG F2-Ref';
%common to all
'POL E'; 'POL EKG'};
chans2exc{56} = chans2exc{55};


chans2exc{57} = {'EEG A1-Ref';'EEG A2-Ref';'POL A3';'POL B1';'POL B2';'POL B3';'EEG C1-Ref';'EEG C2-Ref';'EEG C3-Ref';...
'POL D1';'POL D2';'POL D3';'POL D4';'POL D5';'POL D6'; 'EEG M1-Ref';'EEG M2-Ref'; 'POL K1';'POL K2';...
'POL M3';...
%scalp
%visual inspection
'POL L1';'POL L2';'POL L3';'POL L4';'POL L5';'POL L6';...
'POL K11';'POL K12';'POL K13';'POL K14';'POL K15';'POL K16';'POL K17';'POL K18';...

'POL A12'; 'POL B11'; 'POL D11'; 'POL L11';

%common to all subjects
'POL E';'POL EKG'};
chans2exc{58} = chans2exc{57};

chans2exc{59} = {
    'POL B1';'EEG C1-Ref';
    'POL E';'POL EKG';
    'POL A5';
};
chans2exc{60} = chans2exc{59};

chans2exc{61} = {
    'POL D1'; 'POL D2'; 'POL D3'; 'POL D4'; 'POL D5'; 'POL D6'; 'POL D7'; 
    'EEG F1-Ref';'EEG F2-Ref';'EEG F3-Ref';'EEG F4-Ref'; 
    'POL I7';'POL I8';'POL I9';'POL I10';'POL I11';'POL I12';'POL I13';
    'POL H6';'POL H7';'POL H8';'POL H9';
    'POL E';'POL EKG';
};
chans2exc{62} = chans2exc{61};

chans2exc{63} = { 'EEG C5-Ref';'EEG C6-Ref';'POL C7';'POL C8';'POL C9';'POL C10';'POL E';'POL EKG'};
chans2exc{64} = chans2exc{63};



% % % JINGs (check subject_information excel sheet)
chans2exc{65} = {'A-6'}; % all electrodes would have to be removed (bilateral) %(s51)
chans2exc{66} = chans2exc{65};chans2exc{67} = chans2exc{65};chans2exc{68} = chans2exc{65};
chans2exc{69} = {'I-1' 'I-2' 'I-3' 'I-4' 'I-5' 'I-6' 'I-7' 'I-8' 'I-9' 'I-10' 'I-11';
                }; %only right hippocampal electrodes should be removed (no hipp electrodes in the current analysis) %(s52)
chans2exc{70} = chans2exc{69};chans2exc{71} = chans2exc{69}; 
chans2exc{72} = {}; %no elec were removed (all contralateral in the vvs analysis) %(s53)
chans2exc{73} = chans2exc{72};chans2exc{74} = chans2exc{72};chans2exc{75} = chans2exc{72};
chans2exc{76} = {}; % all electrodes would have to be removed (s54)
chans2exc{77} = chans2exc{76};chans2exc{78} = chans2exc{76};chans2exc{79} = chans2exc{76};
chans2exc{80} = {'A-5' 'F-6'}; % all electrodes would have to be removed (s55)
chans2exc{81} = chans2exc{80};chans2exc{82} = chans2exc{80};chans2exc{83} = chans2exc{80};

% number of electrodes per subject is small
% The info about location of seizures is broad (i.e., "right temporal lobe"), 
% Electrodes were included after careful inspection of raw traces and spectrograms. 




art_rejec{1} = [79932.9727891157,84138.2912801484;808813.615955473,816172.923314781;520130.870129870,526191.476190476];           
art_rejec{2} = [275743.115027829,280103.040816327;314951.525664811,316497.598639456;131535.941249227,133483.993197279;474362.162646877,476588.507730365;508684.982683983,509890.919604205;630793.826221398,632772.799628943;659983.683982684,661591.599876314;692049.237476809,694120.975262832;717002.855287570,718610.771181200;766569.954854669,768641.692640693;874424.005565863,877454.308596166];
art_rejec{3} = [328154.988868275,329886.590599876;431772.799628943,433689.930117502;440183.436611008,443059.132343847;559880.406307978,562230.437229437;926330.622758194,928093.145949289;961302.793444651,963374.531230674;1004715.90414348,1007777.12863327];
art_rejec{4} = [7406.68954854669,11735.6938775510;51284.2405689549,54190.8577612863;84679.4168212740,88513.6777983921;376949.051948052,383009.658008658;659323.820037106,662168.594310451;723887.827458256,727381.952380952;820393.702535560,825464.821892393;860931.735930736,863560.059987631;888791.970933828,894079.540507112;950993.578849722,954364.017934447];
art_rejec{5} = [23856.9059987631,28556.9678416821;157035.632034632,159478.427334570;297882.880024737,301964.512677798;352459.256029685,354963.894248609;362292.280148423,364580.468150897;412477.808905380,413714.667285096;417425.242424242,419095.001236858;448841.445269017,450078.303648732;537338.662337662,538822.892393321;551593.455163884,554159.936301793;600047.382189239,603015.842300557;762570.573283859,764982.447124304;836039.961038961,839101.185528757;991327.530612245,993399.268398268];
art_rejec{6} = []; 
art_rejec{7} = []; 
art_rejec{8} = [97913.8014842301,98686.8379715523;231525.427952999,232082.014223871;295811.142238714,296398.649969079;419775.273345702,420610.152752010;454129.014842301,456819.181818182;466930.499072356,468414.729128015;502953.999381571,519960.802102659;537740.641311070,544945.341372913;576577.994434137,578062.224489796;666466.677179963,675619.429189858;868847.629560915,871847.011131725;931494.506493507,933473.479901051;1002906.99876314,1003710.95670996];
art_rejec{9} = [21475.9536178108,23393.0841063698;56602.7316017316,59818.5633889920;208303.411873840,217734.457019171;201469.769325912,203727.035868893;248655.916512059,250078.303648732;232267.542980829,234741.259740260;271135.817563389,288822.892393321;300789.497217069,304345.465058751;374939.157081014,385050.474335189;406200.752628324,409787.641929499;435328.767470625,437771.562770563;458643.547928262,460715.285714286;464116.646258503,474351.649350649;488977.499690785,490801.865800866;519527.901669759,528928.025355597;536874.840445269,548779.602350031;737369.583797155,739070.264069264;845409.163265306,846336.807050093;812725.180581324,814673.232529375];
art_rejec{10} = [41945.9598021027,44419.6765615337;136163.646876933,139317.635745207;100171.068027211,102026.355596784;165353.504638219,166281.148423006;535421.531849103,537276.819418677;539441.321583179,542688.074829932;937709.719851577,939379.478664193];
art_rejec{11} = [269404.215831787,271197.660482375;279515.533085962,281494.506493507;292471.624613482,293708.482993197;330103.040816327,331494.506493507;434215.594928881,435730.746444032;450140.146567718,451191.476190476;517456.163883735,518693.022263451;628093.145949289,630566.862708720;655458.637600495,657870.511440940;756571.810142239,758056.040197897;809014.605442177,812879.787878788;911364.636363636,917858.142857143];
art_rejec{12} = [17085.1063698207,17827.2213976500;44605.2053184910,45872.9851576994;161302.793444651,165106.132962276;241389.373531231,242564.388991960;256757.338899196,259045.526901670;317332.478045764,318321.964749536;338637.363636364,340090.672232529;357901.432900433,359880.406307978;380195.805194805,381587.270871985;520331.859616574,521414.110698825;588389.991960421,594543.362399505;672805.576376005,676083.251082251;688235.384662956,689874.222016079;741482.137909709,742533.467532468;820331.859616574,822156.225726654;817889.064316636,819775.273345702;886782.076066790,888173.541743970;915724.562152134,916621.284477427;920239.095238095,921073.974644403;927722.088435374,929793.826221398;984693.022263451,985033.158317873];
art_rejec{13} = [2273.72727272727,6602.73160173160;31092.5275200990,31834.6425479283;47573.6654298083,49274.3457019171;553294.135435993,559014.605442177;618167.357452072,619342.372912802;760127.777983921,762168.594310451;827814.852813853,831123.448979592];
art_rejec{14} = [31154.3704390847,32607.6790352505;104129.014842301,111983.065553494;189966.986394558,190678.179962894;498965.131106988,500851.340136054;600047.382189239,601407.926406926;673269.398268398,674939.157081014;730164.883735312,731865.564007421;744821.655534941,745811.142238714;773702.298701299,774629.942486085;779670.140383426,782607.679035250;791327.530612245,792842.682127397;860375.149659864,865384.426097712;883380.715522573,885668.903525046;1133780.83920841,1135326.91218306];
art_rejec{15} = [208458.019171305,211395.557823129;389997.907854051,391822.273964131;1077855.05071119,1079957.70995671];
art_rejec{16} = [109261.977118120,110993.578849722;198872.366728510,200325.675324675;329020.789734075,331370.820655535;396646.021645022,401036.868893012;401315.162028448,448717.759431045;450356.596784168,473393.084106370;804623.758194187,807808.668521954;896151.278293136,898563.152133581;1114449.97959184,1117001];
art_rejec{17} = [6571.81014223871,7623.13976499691;262817.944959802,264054.803339518;270393.702535560,271475.953617811;319404.215831787,320795.681508967;494636.126777984,495780.220779221;501129.633271490,502335.570191713;540678.179962894,542317.017316017;567796.299938157,569249.608534323;635792.589363018,638822.892393321;694481.519480520,695625.613481756;756324.438466296,759354.741496599;768414.729128015,769156.844155844;815879.169449598,817363.399505257;910406.071119357,911333.714904144];
art_rejec{18} = [396213.121212121,399954.617810761;410436.992578850,434555.730983302;527289.188002474,530226.726654298;609354.741496599,610869.893011750;730381.333951763,731865.564007421;1008241.56895485,1010251.46382189;1206783.93135436,1211824.12925170];
art_rejec{19} = [122620.047619048,125866.800865801;134493.888064317,136472.861471861;328649.732220161,329608.297464440;400047.382189239,402613.863327149;513560.059987631,515044.290043290;587524.191094620,590276.200989487;600418.439703154,613962.038961039;905953.380952381,919651.587507730;957252.082251082,960653.442795300;1069064.07977737,1070919.36734694];
art_rejec{20} = [82855.0507111936,85514.2962275819;170795.681508967,172712.811997526;284401.123685838,286318.254174397;420981.210265925,423176.633889920;428680.653679654,429237.239950526;458241.568954855,461333.714904144;496676.943104515,500665.811379097;574289.806431664,576330.622758194;618476.572047001,619775.273345702;679113.554112554,680814.234384663;715817.326530612,722125.304267161;736534.704390847,738266.306122449;795780.220779221,798130.251700680];
art_rejec{21} = [232885.972170686,244543.362399505;272279.911564626,276052.329622758;303294.135435993,304654.679653680;395192.713048856,396862.471861472;459292.898577613,461117.264687693;524073.356215213,532855.050711194;540523.572665430,541945.959802103;544512.440940012,546398.649969079;661086.343228200,665415.347557205;674753.628324057,677412.873840445;739008.421150278,739843.300556586;755551.401978973,762137.672850959;772063.461348176,773362.162646877;791976.881261596,792749.917748918;802675.706246135,805273.108843537;807808.668521954,809880.406307978;814116.646258503,815693.640692641;826021.408163265,826949.051948052;937493.269635127,949305.267161410;971100.567099567,975058.513914657];
art_rejec{22} = [111210.029066172,113405.452690167;145934.828076685,148655.916512059;140585.415584416,142100.567099567;170517.388373531,172187.147186147;216806.813234385,221414.110698825;273300.319727891,277814.852813853;357159.317872604,358550.783549784;397975.644403216,399861.853432282;414178.489177489,416219.305504020;443275.582560297,445440.084724799;484926.788497217,486936.683364255;456788.260358689,458086.961657390;459138.291280148,460189.620902907;611983.065553494,612972.552257267;736101.803957947,738111.698824985;862972.552257267,865879.169449598;962013.987012987,977196.423623995];
art_rejec{23} = [];
art_rejec{24} = [];
art_rejec{25} = [5644.16635745207,9602.11317254174;506262.595547310,509725.799010513];
art_rejec{26} = [];
art_rejec{27} = [];
art_rejec{28} = []; 
art_rejec{29} = [267139.218923933,271622.830550402;562052.638837353,566629.014842301;891907.307977737,896050.783549784;1004399.57761286,1009037.79653680];
art_rejec{30} = [495617.883116883,499142.929499072;628487.394557823,632708.173778602;894844.846629561,898199.824984539]; 
art_rejec{31} = [];
art_rejec{32} = [571174.469387755,595927.097711812];
art_rejec{33} = [187933.900432900,190747.753246753;777621.593692022,780095.310451453;914912.873840445,917432.972789116]; 
art_rejec{34} = [626152.824366110,628657.462585034;1042165.81137910,1048551.09276438]; 
art_rejec{35} = [50086.0340136054,52698.8973407545;602018.625231911,605172.614100186;991273.418058132,994427.406926407]; 
art_rejec{36} = [553348.247990105,559192.403834261;739278.983920841,740855.978354978;869458.328385900,870865.254792826;935939.466295609,940082.941867656;960753.319109462,970710.029066172]; 
art_rejec{37} = [175132.416202845,176755.792826221;302760.740259740,312099.021026592]; 
art_rejec{38} = [188428.643784787,190562.224489796;208326.602968460,232012.440940012;245053.875695733,258597.474953618;292966.677179963,298300.628942486;355350.721706865,363622.212121212;400944.413729128,401052.638837353;365987.703772418,403650.041434756;498857.215213358,501006.256648114;533875.768089054,535839.280766852;840817.635745207,842332.787260359;866420.604205319,869110.771181200;1003031.61224490,1005629.01484230;1112493.57884972,1113915.96598639;1187493.57884972,1189735.38466296;1193708.79220779,1196290.73407545;1215815.16202845,1217825.05689549];
art_rejec{39} = [193236.930735931,195076.757575758;238196.732838590,239433.591218306;397386.590599876,402272.181199753;499056.349412492,500880.715522573;540305.576376005,544711.884353742;526684.673469388,528570.882498454;584013.059369202,585203.535559679;767980.282622140,770562.224489796;898159.627087199,900061.296846011;1031168.28509586,1033410.09090909;1117856.59678417,1127581.39579468;1145082.94186766,1150169.52195424]; 
art_rejec{40} = [550611.698824985,552822.583178726;658218.377860235,659779.911564626;768870.820655535,770215.904143476;888397.722325294,890129.324056895];
art_rejec{41} = [572009.348794063,574483.065553494;602080.468150897,605698.278911565;976982.137909709,978760.121830550;1010516.46072975,1015231.98330241];
art_rejec{42} = [506378.551020408,509486.157699443;765840.517625232,770880.715522573];
art_rejec{43} = []; 
art_rejec{44} = [67757.6481137910,70927.0977118120;133264.760049474,134702.607915894;969735.384662956,974992.032776747];
art_rejec{45} = [411155.916512059,412392.774891775;761944.413729128,764124.376623377];
art_rejec{46} = [124946.887445887,126090.981447124;729569.645640074,734037.796536797];
    


art_rejec{47} = [];
art_rejec{48} = [592842.682127397,598408.544836116;725155.607297464,735514.296227582];
art_rejec{49} = [266044.290043290,300800.010513296;308159.317872604,331783.312925170;485091.909090909,488988.012987013;587380.097093383,599686.837971552;660787.641929499,662704.772418058];
art_rejec{50} = [102119.119975263,106509.967223253;183535.322820037,185730.746444032;201686.219542362,204252.700680272;269868.037724181,271816.089672233;343275.582560297,349490.795918367;411642.929499072,414116.646258503;429422.768707483,433720.851576994;587245.897959184,597480.901051330;600232.910946197,648903.288188003;650511.204081633,690956.473098330;944324.438466296,945994.197278912];
art_rejec{51} = [971370.820655535,973287.951144094;709620.666048238,712403.597402597;693696.114409400,695365.873222016;156095.619666048,160795.681508967];
art_rejec{52} = [140461.729746444,141543.980828695;987338.662337662,989441.321583179;919218.687074830,920702.917130489;942564.388991960,944141.383426098];
art_rejec{53} = [24011.5132962276,24444.4137291280;116373.912801484,117332.478045764;167023.263450835,168229.200371058;228804.339517625,229670.140383426;457066.553494125,458303.411873840;555551.401978973,556757.338899196;741636.745207174,744697.969696970;1542378.86023500,1543461.11131725;1586658.39022882,1587493.26963513;1664982.44712430,1665848.24799011];
art_rejec{54} = [5036.25046382189,6087.58008658009;14405.4526901670,16044.2900432900;29309.5961657390,30299.0828695114;60354.7414965986,60880.4063079777;120373.294372294,121270.016697588;169909.472479901,171053.566481138;219631.179344465,220651.587507730;237287.332714904,238493.269635127;275660.863945578,276464.821892393;470187.765615337,470868.037724181;712766.615337044,713632.416202845;927423.387136673,928227.345083488];
art_rejec{55} = [252861.235003092,258798.155225727;554469.150896722,597728.272727273;859138.291280148,893863.090290662;1132743.11502783,1148976.88126160];
art_rejec{56} = [256695.495980210,281803.721088435;527660.245516388,532762.286332715;686812.997526283,692131.488559060;750480.282622140,768105.514533086;952304.648732220,962013.987012987;970919.367346939,976608.915893630;1027474.71675943,1046182.19975263];
art_rejec{57} = [78673.1068249258,86907.5281899110;440430.808286951,446367.728509586;603448.742733457,605798.773654917;652613.863327149,655365.873222016;708179.726035869,710591.599876314;743492.032776747,749336.188620903;884277.437847866,887895.248608534];
art_rejec{58} = [118909.472479901,123393.084106370;252304.648732220,255613.244897959;588606.442176871,591945.959802103;847326.293753865,849800.010513296;875093.764378479,878124.067408782];
art_rejec{59} = [10073.6654298083,12176.3246753247;114634.580705009,115763.213976500;188706.936920223,189974.716759431;204322.273964131,204956.163883735;261542.434755720,262578.303648732;337191.785405071,338134.889919604;343314.234384663,344025.427952999;423524.500309215,424096.547309833;462547.382189239,463475.025974026;487933.900432900,489449.051948052;570509.658008658,572535.013605442;597535.013605442,598416.275200989;762330.931972789,762794.753865182;810738.476808905,811542.434755720;890206.627705628,890979.664192950;895092.218305504,896329.076685220;1024096.54730983,1025488.01298701;1049170.75881262,1050268.47062461;1054334.64254793,1055076.75757576];
art_rejec{60} = [183527.592455164,185104.586889301;262083.560296846,263861.544217687;278812.069882499,279801.556586271;316412.564625850,318747.134817563;706826.912183055,708233.838589981;766381.643166357,768886.281385281;775163.337662338,776817.635745207;779832.478045764,780667.357452072];
art_rejec{61} = [276075.520717378,286836.188620903;373354.432282004,377590.672232529;391969.150896722,394272.799628943];
art_rejec{62} = [];
art_rejec{63} = [35506.5658627087,42417.5120593692;62470.0785405071,65237.5491651206;56749.6085343228,58171.9956709957;89510.8948670377,91458.9468150897;115825.056895485,124112.008039579;129198.588126160,130033.467532468;145556.040197897,147658.699443414;186248.680890538,186774.345701917;194628.396413111,195927.097711812;231517.697588126,232800.938157081;248632.725417440,249761.358688930;251492.960420532,252111.389610390;305899.268398268,306455.854669140;321437.301793445,337964.821892393;369071.810142239,370648.804576376;382831.859616574,384331.550401979;393345.155844156,394458.328385900;424204.772418058,424699.515769944;428456.473098330,429136.745207174;438444.104514533,439665.502164502;454878.860235003,455590.053803340;479538.724180581,481100.257884972;526492.960420532,527961.729746444;603270.944341373,610228.272727273;637176.324675325,639155.298082870;658280.220779221,661032.230674088;680280.839208411,681115.718614719;690608.606679035,691582.632653061;716582.632653061,718298.773654917;723261.667903525,724112.008039580;731672.304885591,732569.027210884;753595.619666048,754940.703153989;1053904.83426098,1054523.26345084;1068206.00927644,1068855.35992579;1110831.24118738,1112748.37167594;1106455.85466914,1107615.40940012];
art_rejec{64} = [42340.2084106370,47936.9925788497;60753.9375386518,62593.7643784787;92974.0983302412,94350.1032776747;111155.916512059,112485.539270254;125503.473716759,126137.363636364;145571.500927644,146576.448361163;163784.240568955,165593.145949289;170138.600494743,171916.584415584;291319.800247372,293128.705627706;250070.573283859,251740.332096475;309702.607915894,319690.239332097;304059.441558442,306610.461966605;432337.116264688,434594.382807669;688521.408163265,689851.030921460;710073.665429808,710939.466295609;715685.910327768,717402.051329623;784285.168212740,785150.969078541;789897.413110699,792742.187384045;797550.474335189,799081.086580087;911124.995052567,911944.413729128;943453.380952381,945154.061224490;974003.782931354,975256.102040816;984161.482374768,989294.444650588;1001060.05998763,1002482.44712430;1021452.76252319,1023076.13914657];
art_rejec{65} = [51353.8138528139,53734.7662337662;320045.836116265,321344.537414966;409949.979591837,411990.795918367;522705.081632653,525998.217068646;700225.180581324,743932.663574521;920339.589981447,922643.238713667];
art_rejec{66} = [305821.964749536,307476.262832406;540902.360544218,543468.841682127;584146.021645022,593144.166357452;559702.607915894,561341.445269017;650178.798392084,659826.293753865;668948.124304267,670973.479901051;700132.416202845,703209.101422387;884965.440321583,889479.973407545;954646.949288806,996947.505875077;1141752.70068027,1145277.74706246];
art_rejec{67} = [75966.3465346535,79283.1782178218;408233.838589981,410908.544836116;496669.212739641,498849.175633890;700271.562770563,703240.022881880;1211635.19913420,1215825.05689549;1271870.20222635,1281162.10080396];
art_rejec{68} = [133774.964131107,136356.905998763;208991.414347557,211758.884972171;400086.034013605,402575.211502783;662810.214594929,672643.238713667;746390.919604205,749421.222634508;829415.038342610,831718.687074830;877250.536178108,879105.823747681;895880.715522573,897828.767470625;1105512.75015461,1115747.75324675;1222627.77798392,1227497.90785405;1284609.84353742,1288397.72232529];
art_rejec{69} = [981603.040816327,983350.103277675;336179.416821274,337385.353741497];
art_rejec{70} = [328363.708719852,329384.116883117;642603.040816327,643762.595547310;741344.537414966,742550.474335189;765633.343846630,787989.559059988];
art_rejec{71} = [234733.529375387,235954.927025356;438335.879406308,448493.578849722;510197.351267780,515531.303030303;1575179.41682127,1577390.30117502;691907.926406926,695819.491032777;757832.478045764,762640.764996908];
art_rejec{72} = [67092.8367346939,67958.6376004948;417463.894248609,419102.731601732;522705.081632653,523972.861471862;566072.428571429,566876.386518244;612253.628324057,612887.518243661;653827.530612245,655311.760667904;743515.223871367,744520.171304886;704755.174397032,705466.367965368;1012949.36116265,1014186.21954236;1055837.42547928,1056610.46196661;1157816.39888683,1158697.66048237;1247079.23129252,1250310.52380952];
art_rejec{73} = [99323.5108225108,100606.751391466;200142.929499072,200761.358688930;286073.665429808,286444.722943723];
art_rejec{74} = [337547.382189239,338706.936920223;512593.764378479,514418.130488559;765237.549165121,766165.192949907;795911.636982066,797504.092145949;923648.186147186,924885.044526902;971622.830550402,972334.024118738];
art_rejec{75} = [119396.485466914,120556.040197897;184779.911564626,185985.848484849;193345.155844156,194180.035250464;500472.552257267,501570.264069264;527838.043908473,528827.530612245;536697.042053185,537933.900432900;641505.329004329,642927.716141002;761573.356215213,762980.282622140;768159.627087199,769210.956709957;1025735.38466296,1026338.35312307];
art_rejec{76} = [389418.130488559,389835.570191713;1103162.71923315,1104043.98082870;1308403.90661719,1309300.62894249;1341304.33951763,1341891.84724799];
art_rejec{77} = [46669.2127396413,47303.1026592455;53410.0909090909,54384.1168831169;526771.253555968,527776.200989487;536851.649350649,537686.528756957;761496.052566481,763691.476190476;884702.607915894,885413.801484230;1119674.77860235,1120231.36487322];
art_rejec{78} = [265639.528138528,266907.307977737;330713.739641311,331579.540507112;347055.730983302,348076.139146568;442448.433518862,443159.627087199;588505.947433519,589062.533704391;713645.094001237,714665.502164502;962361.853432282,963073.047000618;1134068.71799629,1134748.99010513];
art_rejec{79} = [326090.981447124,327065.007421150;401199.206555349,406610.461966605;1183914.11069883,1185243.73345702;1217293.82622140,1218530.68460111;1345246.82560297,1346406.38033395];
art_rejec{80} = [72643.2387136673,73323.5108225108;421128.087198516,421854.741496599;581811.451453309,583805.885590600;631564.079777366,645215.904143476;652822.583178726,666953.690166976;684919.058132344,687006.256648114;876508.421150278,877204.153988868];
art_rejec{81} = [78240.0228818800,78734.7662337663;217680.344465059,220416.893630179;387021.717377860,388150.350649351;443561.606060606,444319.181818182;505883.807668522,507708.173778602;601431.117501546,602296.918367347;731548.619047619,734640.764996908;928734.766233766,929229.509585653];
art_rejec{82} = [177018.625231911,184207.864564007;244968.532467533,249838.662337662;405311.760667904,410150.969078541;485692.094619666,486325.984539270;535723.016079159,537392.774891775;585846.701917131,588026.664811379;961325.984539270,968283.312925170];
art_rejec{83} = [54739.7136672851,59919.0581323439;107800.938157081,110274.654916512;181734.147804576,183094.692022263;335290.115646259,335893.084106370;355419.985776129,356316.708101422;366706.318491033,367309.286951144;620509.658008658,627219.614718615;648797.227581942,652755.174397032;830414.419913420,830816.398886828];


disp(['File > ' num2str(subji)]);
load(sublist{subji});


EEG.event = events;

if subji < 47 %for the german data
   eventChannel = 'Trigger';TTL = strmatch(eventChannel, {EEG.chanlocs.labels}, 'exact');
   EEG.TTL = TTL;
   EEG.comments = '';
   EEG.subj = sublist{subji}(1:end-4);
   
elseif subji > 46 & subji < 65 % for the chinese data
   eventChannel = 'POL DC13';TTL = strmatch(eventChannel, {EEG.chanlocs.labels}, 'exact');
   EEG.TTL = TTL;
   EEG.comments = '';
   EEG.subj = sublist{subji}(1:end-4);
   
else 
   EEG.chanlocs = EEG.chanlocs';
   c = allE{subji}(:,1);
   [EEG.chanlocs.labels] = c{:};
   EEG.TTL = [];
   EEG.comments = '';
   EEG.subj = sublist{subji}(1:end-4);
   
end


%disp('excluding channels in EEG.chans2exc');
%size(EEG.data)
[chansI ids] = intersect({EEG.chanlocs.labels}', chans2exc{subji}); %intersect sorts them
EEG.data(ids, :) = [];EEG.chanlocs(ids, :) = []; EEG.nbchan = size(EEG.data ,1);
EEG.art_rejec = art_rejec{subji} ; 

%include MNI coordinates 
if ~isempty(allE{subji})
    mni_label = cellstr(allE{subji}(:,1)); 
    mni_coord = cell2mat(allE{subji}(:,2:4));
else
    mni_label = []; 
    mni_coord = [];
end

for i = 1:length(mni_label)
   id =  strmatch(mni_label(i),{EEG.chanlocs.labels}, 'exact'); %this looks for 
   if ~isempty(id)
        EEG.chanlocs(id).X = mni_coord(i, 1);
        EEG.chanlocs(id).Y = mni_coord(i, 2);
        EEG.chanlocs(id).Z = mni_coord(i, 3);
   end
end

cd (currentFolder)



